function initMap(){"use strict";function d(a){var b="<h3>"+a.name+"</h3><br><div style='width:100px;min-height:70px'><img src=\""+a.photoUrl+'"></div><div><a href="'+a.shortUrl+'" target="_blank">More details on Foursquare</a><img src="img/Foursquare_150.png">',c="Sorry, Foursquare content currently not available.";return a.name.length>0?b:c}function e(a){null!==a.getAnimation()?a.setAnimation(null):(a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},700))}function f(){var b=this;this.isNavClosed=ko.observable(!1),this.navClick=function(){this.isNavClosed(!this.isNavClosed())},this.pointList=ko.observableArray(),initialPoint.forEach(function(a){b.pointList.push(new c(a))}),this.pointList().forEach(function(b){var c=new google.maps.Marker({map:map,position:b.location,icon:a,animation:google.maps.Animation.DROP});b.marker=c,bounds.extend(c.position),c.addListener("click",function(a){map.panTo(this.position),map.panBy(0,-200),infowindow.setContent(d(b)),infowindow.open(map,c),e(c)})}),b.getFoursquareData=ko.computed(function(){b.pointList().forEach(function(a){var b=a.fs_id+"/?",c=BaseUrl+b+fsClient_id+fsClient_secret+fsVersion;$.ajax({type:"GET",url:c,dataType:"json",cache:!1,success:function(b){var c=b.response?b.response:"";c.venue?b.venue:"";a.name=c.venue.name,a.shortUrl=c.venue.shortUrl,a.photoUrl=c.venue.bestPhoto.prefix+"height150"+c.venue.bestPhoto.suffix}}),$.ajax({type:"GET",url:c,dataType:"json",cache:!1}).fail(function(){alert("Foursquare has failed to load. Please reload and try again later.")})})}),$(document).ready(function(){$(".close").click(function(){$("#Alert").alert()})}),this.itemClick=function(a){a.markerId;google.maps.event.trigger(a.marker,"click")},b.filter=ko.observable(""),this.filteredPointList=ko.dependentObservable(function(){var a=this.filter().toLowerCase();return a?ko.utils.arrayFilter(this.pointList(),function(b){return b.name.toLowerCase().indexOf(a)>=0||(b.marker.setVisible(!1),!1)}):ko.utils.arrayFilter(b.pointList(),function(a){return a.marker.setVisible(!0),!0})},this)}var a={url:"img/star.ico",size:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,32)},b={center:{lat:41.3910101,lng:2.1535417},zoom:13,styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"landscape",elementType:"labels.icon",stylers:[{saturation:"-100"},{lightness:"-54"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"on"},{lightness:"0"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"poi",elementType:"labels.icon",stylers:[{saturation:"-89"},{lightness:"-55"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"transit.station",elementType:"labels.icon",stylers:[{visibility:"on"},{saturation:"-100"},{lightness:"-51"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}],mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};map=new google.maps.Map(document.getElementById("map"),b),infowindow=new google.maps.InfoWindow({maxWidth:150,content:"Barcelona"}),bounds=new google.maps.LatLngBounds,map.addListener("click",function(){infowindow.close(infowindow)}),window.onresize=function(){map.fitBounds(bounds)};var c=function(a,b,c){this.name=ko.observable(a.name),this.location=a.location,this.marker="",this.markerId=b,this.fs_id=a.fs_id,this.shortUrl="",this.photoUrl=""};ko.applyBindings(new f)}var initialPoint=[{name:"La Sagrada Familia",location:{lat:41.4036299,lng:2.1721671},fs_id:"4adcda50f964a520544121e3"},{name:"La Rambla",location:{lat:41.3806562,lng:2.1716642},fs_id:"4e04dda152b1cef647d55881"},{name:"Park Güell",location:{lat:41.4144948,lng:2.1505058},fs_id:"4b76bca2f964a520975b2ee3"},{name:"Parc de la Ciutadella",location:{lat:41.388123,lng:2.1838265},fs_id:"4adcda50f964a5203b4121e3"},{name:"Casa Batlló",location:{lat:41.3916408,lng:2.1626786},fs_id:"4adcda51f964a520aa4121e3"},{name:"Montjuïc",location:{lat:41.3639993,lng:2.1587383},fs_id:"5453c6cf498e75ddfe254ab2"},{name:"Camp Nou Stadium",location:{lat:41.380896,lng:2.1206311},fs_id:"507fe73fd63e93639fd2a84f"},{name:"Palau de la Música Catalana",location:{lat:41.3875752,lng:2.1731241},fs_id:"4af1b973f964a52083e221e3"},{name:"Museu Picasso de Barcelona",location:{lat:41.385216,lng:2.178704},fs_id:"4b55e65af964a52054f527e3"},{name:"CosmoCaixa Barcelona",location:{lat:41.412972,lng:2.1293623},fs_id:"4bb7834598c7ef3b0ae12f02"},{name:"Poble Espanyol",location:{lat:41.3688085,lng:2.1460845},fs_id:"4adcda5af964a520504421e3"},{name:"Columbus Monument, Barcelona",location:{lat:41.3757974,lng:2.1755696},fs_id:"4b9cfc34f964a5209c8636e3"},{name:"Casa Museu Gaudi",location:{lat:41.4044181,lng:2.158967},fs_id:"4adcda52f964a520d34121e3"}],BaseUrl="https://api.foursquare.com/v2/venues/",fsClient_id="client_id=AT0ECWQZ2FSMLVFY0RMA4L05YDQGGYUFHRR1YRRRD0RLOLXC",fsClient_secret="&client_secret=JOJY3UZPPBNZQ1IPGC2MCODJLPBC2QLIZV2HE31ANCY4PUAT",fsVersion="&v=20161110",map,infowindow,bounds;